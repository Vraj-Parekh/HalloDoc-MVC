@model List<AdminDashboardDTO>

@{
    ViewData["Title"] = "_NewStateTable";
}

@functions {
    public string GetColor(int RequestTypeId)
    {
        switch (RequestTypeId)
        {
            case 1: return "green";
            case 2: return "orange";
            case 3: return "pink";
            case 4: return "blue";
            default: return "green";
        }
    }

    public string showName(int Status)
    {
        switch (Status)
        {
            case 1: return "New";
            case 2: return "Pending";
            case 3: return "Active";
            case 4: return "Conclude";
            case 5: return "To close";
            case 6: return "Unpaid";
            default: return "Unknown";
        }
    }
}
<div class="table-responsive d-none d-sm-block">
    <table class="table" id="adminTable">
        <thead>
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Date Of Birth</th>
                <th scope="col">Requestor</th>
                <th scope="col">Requested date</th>
                <th scope="col">Phone</th>
                <th scope="col">Address</th>
                <th scope="col">Notes</th>
                <th scope="col">Chat With</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody class="text-white">
            @foreach (var a in Model)
            {
                <tr class="align-middle table-@{
                            @GetColor(a.RequestTypeId)
}" data-request-type="RequestTypeId">
                    <td scope="row">@a.Name, @a.RequestId</td>
                    <td>@a.Dob.ToString("MMM,dd yyyy")</td>
                    <td>@a.Requestor</td>
                    <td>@a.RequestedDate.ToString("MMM,dd yyyy")</td>
                    <td>
                        <div>
                            <span class="border border-white rounded p-2 text-nowrap"><i class="bi bi-telephone p-2"></i>@a.Phone</span>
                        </div>

                    </td>
                    <td>@a.Address</td>
                    <td>@a.Notes</td>
                    <td><button class="btn btn-outline-secondary">Provider</button></td>
                    <td>
                        <div class="dropdown">
                            <button class="btn text-white border border-white" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Action
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item">Assign Case</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal"><i class="fa-solid fa-xmark me-1"></i>Cancel Case</a></li>
                                <li><a class="dropdown-item viewCase" href="@Url.Action("ViewCase", "Admin", new { requestId = a.RequestId })">View Case</a></li>
                                <li><a class="dropdown-item viewNotes" href="@Url.Action("ViewNotes", "Admin", new { requestId = a.RequestId })">View Notes</a></li>
                                <li><a class="dropdown-item" >Block Patient</a></li>
                            </ul>

                            <!-- Modal For Cancel Case For Patient-->
                            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header bg-info text-white ">
                                            <h1 class="modal-title fs-5" id="exampleModalLabel">Confirm Cancellation</h1>
                                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row mb-3">
                                                <div class="col text-muted">
                                                    Patient Name: <span class="text-info">@a.Name</span>
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <div class="col">
                                                    <div class="form-floating">
                                                        <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                                                            <option selected>Select</option>
                                                            <option value="1">One</option>
                                                            <option value="2">Two</option>
                                                            <option value="3">Three</option>
                                                        </select>
                                                        <label for="floatingSelect">Reasons For Cancellation</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating">
                                                        <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea2" style="height: 100px"></textarea>
                                                        <label for="floatingTextarea2">Provide Additional Notes</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-info text-white">Confirm</button>
                                            <button type="button" class="btn btn-white border-info text-info" data-bs-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<script>
    $(document).ready(function () {
        $(".req_type").on("click", function () {
            var requestType = $(this).data("type");
            $("#adminTable tbody tr").show();
            $("#adminTable tbody tr").each(function () {
                var rowRequestType = $(this).data("request-type");
                if (rowRequestType != requestType) {
                    $(this).hide();
                } else {
                    $(this).show();
                }
            });
        });
    });
</script>

<script>
    $(document).ready(function () {

        $('#adminTable').DataTable({
            "initComplete": function (settings, json) {

                $('#my-search-input').val(settings.oPreviousSearch.sSearch);

                $('#my-search-input').on('keyup', function () {
                    var searchValue = $(this).val();
                    settings.oPreviousSearch.sSearch = searchValue;
                    settings.oApi._fnReDraw(settings);
                });
            },
            "lengthMenu": [[5, 10, -1], [5, 10, "All"]],
            "pageLength": 5,
            language: {
                oPaginate: {
                    sNext: '<i class="bi bi-caret-right-fill text-info"></i>',
                    sPrevious: '<i class="bi bi-caret-left-fill text-info"></i>'
                }
            }
        });
        $('.dataTables_filter').hide();
    });
</script> 